function Cotacao(a,b){this.ini_coluna=b,this.tabela_ini=a}function funcBuscaMes(a){switch(a){case"Jan":return"01";case"Feb":return"02";case"Mar":return"03";case"Apr":return"04";case"May":return"05";case"Jun":return"06";case"Jul":return"07";case"Aug":return"08";case"Sep":return"09";case"Oct":return"10";case"Nov":return"11";case"Dec":return"12"}}function parseData(a){var b=a.split(" "),c=b[2],d=funcBuscaMes(b[1]),e=b[5],f=b[3].split(":"),g=f[0],h=f[1],i="Última atualização "+c+"/"+d+"/"+e+" - "+g+"h"+h;return i}function pegarDiv(a){document.getElementById?this.obj=document.getElementById(a):document.all?this.obj=document.all[a]:document.layers&&(this.obj=document.layers[a])}function escrever_campo(a,b){if(DHTML){var c=new pegarDiv(a);c.obj&&(c.obj.innerHTML=b)}}function pegaCor(a){return cor="semvar",temp=a.replace(",","."),0==parseFloat(temp)?cor="semvar":parseFloat(temp)>0?cor="varpos":parseFloat(temp)<0&&(cor="varneg"),cor}var ns4=document.layers,ie4=document.all,ns6=document.getElementById&&!document.all;Cotacao.prototype.xmlHttp=void 0,Cotacao.prototype.xmlDoc=void 0,Cotacao.prototype.ini_coluna=0,Cotacao.prototype.prefixo_i=0,Cotacao.prototype.tabela_ini=0,Cotacao.prototype.nome_arquivos=new Array,Cotacao.prototype.pregaoAberto=function(){if(ns6){if(this.xmlDoc.childNodes[0])var a=this.xmlDoc.childNodes[0].childNodes[2].attributes[0].value}else if(ie4&&this.xmlDoc.childNodes[1])var a=this.xmlDoc.childNodes[1].childNodes[2].attributes[0].value;return 1==a},Cotacao.prototype.escreveXMLCotacao=function(){var a=this.xmlDoc.getElementsByTagName(tag_ativos),b=this.xmlDoc.getElementsByTagName(campo_data);for(data_atualizado=b[0].firstChild.data,data_hora=parseData(data_atualizado),campo_id_data="id_data",escrever_campo(campo_id_data,data_hora),i=0;i<a.length;i++)if(a[i].firstChild)for(j=this.ini_coluna;j<a[0].childNodes.length;j++)if(0==this.ini_coluna?campo_id="t"+this.tabela_ini+"l"+(i+1)+"c"+j:campo_id="t"+this.tabela_ini+"l"+(i+1)+"c"+(j-1),a[i].childNodes[j].firstChild){var c=a[i].childNodes[j].nodeName,d=a[i].childNodes[j].firstChild.data;if("ultima"==c&&1==arredonda_decimal){var e=d.replace(",",".");d=Number(e),d=d.toFixed(2),d=d.replace(".",",")}c==campo_variacao&&(cor_variacao=pegaCor(d),d='<img src="/img/financial/'+cor_variacao+'.png" align="bottom"> <SPAN CLASS="'+cor_variacao+'">'+d+"%</SPAN>",mostrar_imagem&&(campo_seta="cel_imagem_t"+this.tabela_ini+"l"+(i+1),valor_seta='<img src="/img/financial/'+cor_variacao+'.png">',escrever_campo(campo_seta,valor_seta))),escrever_campo(campo_id,d)}else escrever_campo(campo_id,"-");else for(j=this.ini_coluna;j<a[0].childNodes.length;j++)campo_id="t"+this.tabela_ini+"l"+(i+1)+"c"+(j-1),escrever_campo(campo_id,"-")},Cotacao.prototype.createXMLHttpRequest=function(){try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(a){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}try{return new XMLHttpRequest}catch(a){}return alert("XMLHttpRequest not supported"),null},Cotacao.prototype.ler_xml=function(a){var b="GET",c=this;if(this.xmlHttp=this.createXMLHttpRequest(),this.str_http=a.substr(0,6),"http:/"==this.str_http&&(b="POST"),this.xmlHttp.onreadystatechange=function(){c.esperaXML()},gambi_ie_dt=new Date,gambi_ie_dt_hr=gambi_ie_dt.getTime(),a+="?hora="+gambi_ie_dt_hr,window.XMLHttpRequest)try{this.xmlHttp.open(b,a,!0)}catch(d){alert(d)}else window.ActiveXObject&&this.xmlHttp.open(b,a,!0);this.xmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=ISO-8859-1"),this.xmlHttp.setRequestHeader("Cache-Control","post-check=0, pre-check=0"),this.xmlHttp.setRequestHeader("Expires","0"),this.xmlHttp.setRequestHeader("Cache-Control","no-store, no-cache, must-revalidate"),this.xmlHttp.setRequestHeader("Pragma","no-cache"),this.xmlHttp.send(null)},Cotacao.prototype.escreve=function(){this.escreveXMLCotacao()},Cotacao.prototype.esperaXML=function(){4==this.xmlHttp.readyState&&200==this.xmlHttp.status&&(this.xmlDoc=null,"http:/"==this.str_http?(this.xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),this.xmlDoc.loadXML(this.xmlHttp.responseText)):this.xmlDoc=this.xmlHttp.responseXML,this.escreve())},Cotacao.prototype.carregar=function(a){this.prefixo_i=a,null!=this.nome_arquivos[a]?this.ler_xml(this.nome_arquivos[a]):this.ler_xml(nome_arquivos[a])};var nome_arquivos=new Array,DHTML=document.getElementById||document.all||document.layers,xmlDocWin,ini_coluna_win;